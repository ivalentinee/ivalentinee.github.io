---
layout: post
title:  "Exploitation first!"
date:   2019-07-17
categories: programming
math: true
uid: exploitation-first
---

## Introduction

This post is mostly for those careless ~~whisperers~~ programmers who write code with no care for exploitation.

## What is exploitation?

<!-- insert wikipedia definition here -->

## Examples

<!-- put some examples here -->

## Standardize it!

By that I mean two things.

### Make exploitation documentation standard
First, ask your exploitation department colleagues (DevOpses?). Especially if you already have some systems in exploitation (i.e. in production). What they use? What information they lack?

Second, inspect your projects (both in exploitation and in early develoment). Think of all common bells and whistles to be configured, some situations that may occur. You may think your system is easy to understand for everybody. Truth is, it's not.

After all common information gathered write a template of exploitation docs and show it to everybody. Discuss it, improve it.

But do not "carve this template in stone". After every incident (especially post mortems) think of adding some things that could help exploitation team make it through harsh times without your help. Amend (but wisely!) it. Remove unused things.

### Make it mandatory for every developer
This is a bit more difficult. If you're on team lead/manager/big boss position, use your power to make documenting exploitation mandatory. If not, use social engineering, meritocracy, your boss, your reputation. Become an asshole. But force everybody to write that. Trust me, it will save your sleep at night (especially if you're team lead/manager).

## Make your system exploitatable
That's complicated too.
<!-- put something about 12 factor apps -->

### Environment configuration files
First thing I encountered countless times is "environment configuration file". God, please, get rid of it! If your `config` folder contains more than `production` and derived from it `development` and `test` configs, you've done bad. Just imagine, what could happen if at 1:00 am your DB server crashes without any chance to restore, but exploitation guys can quickly (within SLA time!) restore it but with different IP address/domain name. How could you change your DB hostname on the go without redeploying your app if you have it (DB hostname) in git-controlled folder with no chance to change it "on the go"? Sleepless night will suddenly get into your life =)

So, to make your system configurable "on the go" either use some sort of config provider, or simply put everything into ENV-variables with default values. And voila, more sleep for your really tired brain that night!

### Add readiness and liveness checks
Or, as some call them, health checks.
Why? Your server needs to know how when your app has loaded (readiness check) and when it crashed (liveness check).
For web apps just `/` with `200 OK` usually is enough for both.

Then describe it in your **exploitation documentation**.

### Add custom monitoring endpoint
Thing is, your exploitation team already has some tool to monitor your app. Help them!

You're unsure of some really weird errors? Push those events to monitoring system! Has external systems? Check them!

We (on projects I developed) used `/healthcheck` with this content:
```
db ok
smtp ok
rabbitmq ok
```

Again, put that into **exploitation documentation**.

### Describe every service
Use DBMS? Has web server? Send emails? Describe it!

For every service you should describe:
1. Scalability. It's easy to (auto)scale web service, but (auto)scaling DBMS is a painfull experience.
2. Resources required. Memory, CPU, hard drives, sockets, inodes.
3. Backups. What and how to backup and how to restore it.

### Networking
What services are exposed to the world and what connectivity your services require (interconnections, infranet endpoints).

### Environment variables
Well, environment variables, examples and default values.

### Handles
Have script to wash it out? Internal buttons to rebuild caches?\\
If no, make em.\\
Then describe em.
